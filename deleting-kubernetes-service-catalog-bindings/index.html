<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Deleting Kubernetes Service Catalog bindings &#183; TIL</title><link rel=stylesheet href=/til/css/style.css><link rel=stylesheet href=/til/css/fonts.css><link rel=icon type=image/png sizes=32x32 href=/til/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/til/images/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/til/images/apple-touch-icon.png><link href rel=alternate type=application/rss+xml title=TIL></head><body><nav class=nav><div class=nav-container><a href=/><h2 class=nav-title>TIL</h2></a><ul></ul></div></nav><main><div class=post><div class=post-info><span>Written by</span>
Hector Rios<br><span>on&nbsp;</span><time datetime="2021-02-23 00:00:00 +0000 UTC">February 23, 2021</time></div><h1 class=post-title>Deleting Kubernetes Service Catalog bindings</h1><div class=post-line></div><h1 id=tldr>tl;dr</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>svcat unbind &lt;instance-name&gt; <span style=color:#75715e># this will remove all the bindings for this service catalog instance</span>
</span></span><span style=display:flex><span>svcat unbind --name &lt;binding-name&gt; <span style=color:#75715e># this will remove a specific binding</span>
</span></span></code></pre></div><h1 id=motivation>Motivation</h1><p>I recently used my company&rsquo;s <a href=https://kubernetes.io/docs/concepts/extend-kubernetes/service-catalog/>Kubernetes Service Catalog</a> to spin up an <a href=https://aws.amazon.com/elasticache/redis/>Elasticache</a> instance for an application. <a href=https://kubernetes.io/docs/concepts/extend-kubernetes/service-catalog/#binding-to-a-managed-service>When you create a ServiceInstance, you need to bind it to an application</a> in order to get connection information for that instance.</p><p>From the Service Catalog documentation:</p><blockquote><p>After a new instance has been provisioned, a cluster operator must bind to the managed service to get the connection credentials and service account details necessary for the application to use the service.</p></blockquote><p>That said &ndash; I messed up the original binding.</p><p>I tried to create a <code>ServiceInstance</code> but missed a parameter, resulting in two things:</p><ul><li>The service instance has an orphaned mitigation</li><li>The service binding had an error</li></ul><h1 id=what-i-did>What I did</h1><p>We use the <a href=https://svc-cat.io/docs/cli/><code>svcat</code> cli</a> to interact with Service Catalog.</p><p>Once I found out what the issue was with the <code>ServiceInstace</code>, I patched up the <code>yaml</code> config and ran an apply. <strong>This resulted in an error because the service instance + binding was in a bad state.</strong></p><p>In a panic, I renamed the <code>metadata.name</code> of the service instance and binding, and ran an apply again. This time, the apply worked.</p><p>Something didn&rsquo;t feel right. I should not be blocked on bad state to create a <code>ServiceInstance</code>/<code>ServiceBinding</code>.</p><p>Therefore, I found that I can first delete the bad binding by running the following command:</p><p><code>svcat unbind --name &lt;binding-name></code></p><p>Once the bad binding was removed, I was able to deprovision the bad instance by running:</p><p><code>svcat deprovision &lt;instance-name></code></p><h1 id=closing-thoughts>Closing thoughts</h1><p>When I looked up the webpage for <a href=https://svc-cat.io/docs/cli/#provision-a-service><code>svcat</code></a>, I found the information I was looking for. However, I didn&rsquo;t find a blog or any kind of article with the errors/keywords of issues that I was looking for. Thus, this post was born.</p><p>I hope that this is helpful.</p></div><div class=pagination><a href=/til/migrating-from-lastpass/ class="left arrow">&#8592;</a>
<a href=/til/download-github-asset-easily/ class="right arrow">&#8594;</a>
<a href=# class=top>Top</a></div></main><footer><span>&copy; <time datetime="2022-08-12 02:38:35.0010612 +0000 UTC m=+0.057452708">2022</time> Hector Rios. Made with <a href=https://gohugo.io>Hugo</a> using the <a href=https://github.com/EmielH/tale-hugo/>Tale</a> theme.</span></footer></body></html>